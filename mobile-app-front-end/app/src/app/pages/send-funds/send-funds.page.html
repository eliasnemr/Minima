<ion-app>
<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button class="menu-icon"></ion-menu-button>
    </ion-buttons>
    <ion-title>
      <ion-item lines="none" class="ion-no-padding">
        Send
      </ion-item>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-item class="breadcrumb ion-no-padding" lines="none" *ngIf="tokenArr.length > 0">
  Enter transaction details
</ion-item>

<ion-content *ngIf="!isWebCameraOpen">

  <ion-grid *ngIf="tokenArr.length == 0">
    <ion-row>
      <ion-col style="display: flex; align-items:center; justify-content:center" size="12">
        <ion-label>Fetching tokens...</ion-label>
      </ion-col>
      <ion-col style="display: flex; align-items:center; justify-content:center" size="12">
        <ion-spinner name="crescent"></ion-spinner>
      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-card class="webscan-canvas" *ngIf="isWebCameraOpen">
    <ion-card-header class="medium-text">
    Scan Your Minima QR address now...
    <ion-progress-bar type="indeterminate" reversed="true"></ion-progress-bar>
    </ion-card-header>
    <video height="240" #videoElem></video>
    <hr>
    <ion-button block="full" (click)="scanQR()">Stop Scanning</ion-button>
    <hr>
  </ion-card>


  <form *ngIf="!isWebCameraOpen && tokenArr.length > 0" [formGroup]="sendForm" id="sendForm" (ngSubmit)="sendFunds()">
    <ion-list>
      <ion-item class="no-hover no-ripple" lines="none" style="margin-left: 25px; margin-right: 14px; --padding-start: 0; --padding-end: 0">
        <ion-label position="floating">Token</ion-label>
        <ion-select
          placeholder="Select A Token"
          formControlName="tokenid"    
          interface = 'ion-action-sheet'
          [(ngModel)]='itemSelected'
          class="no-hover no-ripple input"
          (ionChange)="onItemSelection($event)"> 
        <ion-select-option *ngFor="let token of tokenArr;" [value]="token.tokenid" class="token-option">
          {{ token.token + "&mdash;"+ token.tokenid }}
        </ion-select-option>
      </ion-select>
      </ion-item>
      <ion-item class="no-hover no-ripple"  lines="none">
        <ion-label class="medium-text" position="stacked">Address</ion-label>
        <!-- <span (click)="scanQR()" id="qrIcon"> <ion-icon alt="qrCode" src="assets/scan-outline.svg"></ion-icon></span> -->
        <ion-input #address class="medium-text input" formControlName="address" clearInput="true" placeholder="Enter a valid address"></ion-input>
      </ion-item>
      <ion-item class="no-hover no-ripple"  class="error" lines="none" *ngIf="addressFormItem.invalid && addressFormItem.touched">
        <ion-note class="error-message">
          <ion-icon name="alert-circle"></ion-icon> <span> Invalid address format!</span> <br>
          <span>&mdash; An address must begin with 0x or Mx.</span> 
        </ion-note>
      </ion-item>
      <ion-item class="no-hover no-ripple"  lines="none">
        <ion-label class="medium-text" position="stacked">Amount</ion-label>
        <ion-input #amount type="number" formControlName="amount" class="input medium-text" placeholder="Enter token amount"></ion-input>
      </ion-item>
      <ion-item class="error" lines="none" *ngIf="amountFormItem.invalid && amountFormItem.touched">
        <ion-note class="error-message">
          <ion-icon name="alert-circle"></ion-icon> <span> Amount required!</span> <br>
          <span>&mdash; Amount has to be numeric and greater than 0.</span> 
        </ion-note>
      </ion-item>

      <ion-item class="no-hover no-ripple"  lines="none">
        <ion-label position="stacked" style="margin-bottom: 1%;">Message (optional)</ion-label>
        <ion-textarea 
            [(ngModel)]="data.message"
            formControlName="message"
            class="medium-text input"
            auto-grow="false"
            #message 
            placeholder="This message will be public"
            maxlength="255">
            </ion-textarea>
      </ion-item>
      <ion-label *ngIf="data.message" class="length">{{ data.message.length +"/255" }}</ion-label>
    </ion-list>

    <ion-row>
      <ion-col size="12">
        <ion-button #submitBtn type="submit" [disabled]="sendForm.invalid" class="send-funds" fill="clear">  
           Send Funds
        </ion-button>
      </ion-col>
    </ion-row>
    

  </form>

</ion-content>
<ion-footer>
  <!-- <ion-toolbar class="border-t">
    <ion-buttons> 
      <ion-button type="button" class="action-btn medium-text" expand="block" (click)="stopScanning()"  *ngIf="isCameraOpen==true">
        Stop scanning
       </ion-button>
      <ion-button #submitBtn [disabled]="sendForm.invalid" expand="block" *ngIf="isCameraOpen==false">
        <button type="submit" form="sendForm" class="footer">
          <ion-icon slot="start" name="send"></ion-icon> Send Funds
        </button> 
      </ion-button>
    </ion-buttons>
  </ion-toolbar> -->
  <ion-button class="gimme50" fill="none">
    Gimme 50
  </ion-button>
</ion-footer>
</ion-app>

